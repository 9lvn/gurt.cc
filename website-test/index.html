<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Code Editor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for the scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        body {
            font-family: 'Inter', sans-serif; /* Using Inter font */
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center p-4">
    <div class="container mx-auto w-full max-w-6xl bg-white shadow-lg rounded-xl p-6">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-6">Live Code Editor</h1>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
            <div class="flex flex-col">
                <label for="html-code" class="text-lg font-semibold text-gray-700 mb-2">HTML</label>
                <textarea id="html-code"
                          class="w-full h-48 md:h-64 p-4 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm font-mono resize-y"
                          placeholder="&#10;<h1 class='text-blue-600'>Hello, World!</h1>&#10;<button class='bg-blue-500 text-white p-2 rounded'>Click Me</button>"></textarea>
            </div>

            <div class="flex flex-col">
                <label for="css-code" class="text-lg font-semibold text-gray-700 mb-2">CSS</label>
                <textarea id="css-code"
                          class="w-full h-48 md:h-64 p-4 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm font-mono resize-y"
                          placeholder="/* Your CSS code here */&#10;body {&#10;  font-family: sans-serif;&#10;}&#10;.text-blue-600 {&#10;  color: #2563eb;&#10;}"></textarea>
            </div>

            <div class="flex flex-col">
                <label for="js-code" class="text-lg font-semibold text-gray-700 mb-2">JavaScript</label>
                <textarea id="js-code"
                          class="w-full h-48 md:h-64 p-4 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm font-mono resize-y"
                          placeholder="// Your JavaScript code here&#10;document.querySelector('button').addEventListener('click', () => {&#10;  alert('Button clicked!'); // Using alert for demonstration, consider a modal for production&#10;});"></textarea>
            </div>
        </div>

        <div class="flex justify-center mb-6">
            <button id="run-button"
                    class="px-8 py-3 bg-gradient-to-r from-blue-500 to-blue-700 text-white font-bold rounded-full shadow-lg hover:from-blue-600 hover:to-blue-800 transition duration-300 transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-blue-300">
                Run Code
            </button>
        </div>

        <h2 class="text-2xl font-bold text-center text-gray-800 mb-4">Output Preview</h2>
        <div class="bg-gray-200 border border-gray-300 rounded-lg overflow-hidden">
            <iframe id="output-frame" class="w-full h-96 bg-white"></iframe>
        </div>
    </div>

    <script>
        // Get references to the input text areas and the output iframe
        const htmlCode = document.getElementById('html-code');
        const cssCode = document.getElementById('css-code');
        const jsCode = document.getElementById('js-code');
        const outputFrame = document.getElementById('output-frame');
        const runButton = document.getElementById('run-button');

        /**
         * Updates the content of the output iframe with the combined HTML, CSS, and JavaScript.
         */
        function updateOutput() {
            // Get the current values from the text areas
            const htmlContent = htmlCode.value;
            const cssContent = cssCode.value;
            const jsContent = jsCode.value;

            // Construct the full HTML document string
            const fullHtml = `
                <!DOCTYPE html>
                <html lang="en">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Preview</title>
                    <style>
                        /* Inject CSS content */
                        ${cssContent}
                    </style>
                    <script src="https://cdn.tailwindcss.com"></script>
                    <style>
                        body {
                            font-family: 'Inter', sans-serif;
                            margin: 0;
                            padding: 1rem;
                            box-sizing: border-box;
                        }
                    </style>
                </head>
                <body>
                    ${htmlContent}
                    <script>
                        // Custom alert function to replace window.alert
                        function customAlert(message) {
                            const alertBox = document.createElement('div');
                            alertBox.style.cssText = \`
                                position: fixed;
                                top: 50%;
                                left: 50%;
                                transform: translate(-50%, -50%);
                                background-color: #fff;
                                border: 1px solid #ccc;
                                padding: 20px;
                                border-radius: 8px;
                                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                                z-index: 1000;
                                display: flex;
                                flex-direction: column;
                                align-items: center;
                                gap: 15px;
                                max-width: 90%;
                                text-align: center;
                                font-family: 'Inter', sans-serif;
                            \`;

                            const messageText = document.createElement('p');
                            messageText.textContent = message;
                            messageText.style.fontSize = '1.1rem';
                            messageText.style.color = '#333';

                            const closeButton = document.createElement('button');
                            closeButton.textContent = 'OK';
                            closeButton.style.cssText = \`
                                background-color: #007bff;
                                color: white;
                                padding: 10px 20px;
                                border: none;
                                border-radius: 5px;
                                cursor: pointer;
                                font-size: 1rem;
                                transition: background-color 0.3s ease;
                            \`;
                            closeButton.onmouseover = () => closeButton.style.backgroundColor = '#0056b3';
                            closeButton.onmouseout = () => closeButton.style.backgroundColor = '#007bff';

                            closeButton.addEventListener('click', () => {
                                document.body.removeChild(alertBox);
                            });

                            alertBox.appendChild(messageText);
                            alertBox.appendChild(closeButton);
                            document.body.appendChild(alertBox);
                        }

                        // Override the default alert to use our custom function
                        window.alert = customAlert;

                        // Inject JavaScript content
                        try {
                            ${jsContent}
                        } catch (error) {
                            console.error("Error in user JavaScript:", error);
                            // Display error in the iframe if possible, or log to console
                            const errorDiv = document.createElement('div');
                            errorDiv.style.color = 'red';
                            errorDiv.textContent = 'JavaScript Error: ' + error.message;
                            document.body.prepend(errorDiv);
                        }
                    </script>
                </body>
                </html>
            `;

            // Write the constructed HTML to the iframe's document
            outputFrame.contentWindow.document.open();
            outputFrame.contentWindow.document.write(fullHtml);
            outputFrame.contentWindow.document.close();
        }

        // Add event listener to the run button
        runButton.addEventListener('click', updateOutput);

        // Optional: Run code automatically on initial load with default content
        window.onload = () => {
            // Set some default content for demonstration
            htmlCode.value = `<h1 class='text-blue-600'>Hello, Live Editor!</h1>\\n<p>Start typing HTML, CSS, and JS to see it rendered here.</p>\\n<button class='bg-green-500 text-white p-3 rounded-lg shadow-md hover:bg-green-600 transition duration-200'>Interactive Button</button>`;
            cssCode.value = `body { background-color: #f0f9ff; }\\n.text-blue-600 { color: #2563eb; }\\nbutton { margin-top: 1rem; }`;
            jsCode.value = `document.querySelector('button').addEventListener('click', () => {\\n  alert('You clicked the button!');\\n});`;
            updateOutput(); // Render the default content
        };
    </script>
</body>
</html>
